<!DOCTYPE HTML>
<html>
<head>
	<title>demo</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<!--支持多设备-->
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="css/bootstrap.css" rel='stylesheet' type='text/css' />
	<link rel="stylesheet" href="css/eleIndex.css">
	<style>
		#formdiv{width: 66%;float: left;padding:1%;border:1px solid #eee;margin: 10px 0;}
		.treeNodeSpan{float: right; margin-right: 200px;display:none;}
		.treeNodeSpan i{ margin:0 5px;}
		.el-tree{width: 30%;float: left;border: 1px solid #eee;margin: 10px;max-height: 369px;padding:10px;}
	</style>
</head>


<body>

<div id="tableView">  
    <!--列表顶部搜索和工具条 .top-menu li:hover > ul-->
   <el-tree
  :data="data2"
  :props="defaultProps"
  node-key="id"
  :expand-on-click-node="false"
  :render-content="renderContent" >
	</el-tree>
  </div>
<div id="formdiv">
		 <el-form  label-width="93px" :rules="rules" ref="ruleForm" :model="ruleForm">
			  <el-form-item label="子节点名称" prop="name">
				<el-input v-model="ruleForm.name"></el-input>
			  </el-form-item>
			  <el-form-item label="类型" prop="type">
				<el-select  placeholder="请选择类型" v-model="ruleForm.type">
				  <el-option label="区域一" value="shanghai"></el-option>
				  <el-option label="区域二" value="beijing"></el-option>
				</el-select>
			  </el-form-item>
			  <el-form-item label="顺序" prop="orders">
				<el-input v-model="ruleForm.orders"></el-input>
			  </el-form-item>
			  <el-form-item label="描述" prop="desc">
				<el-input type="textarea" v-model="ruleForm.desc"></el-input>
			  </el-form-item>
			  <el-form-item>
				<el-button type="primary" @click="onSubmit('ruleForm')">保存</el-button>
				<el-button>重置</el-button>
			  </el-form-item>
	</el-form>
	</div>	
  
<script src="js/jquery.min.js"></script>
<script src="js/vue.js"></script>
<script src="js/eleIndex.js"></script>
<script>
var tableView = new Vue({  
        el: '#tableView',  
        data() {
		  return {
			data2: [{
			  id: 1,
			  label: '一级 1',
			  type:'菜单',
			  children: [{
				id: 4,
				label: '二级 1-1',
				type:'功能',
				children: [{
				  id: 9,
				  label: '三级 1-1-1',
				  type:'菜单'
				}, {
				  id: 10,
				  label: '三级 1-1-2',
				  type:'功能'
				}]
			  }]
			}, {
			  id: 2,
			  label: '一级 2',
			  type:'功能',
			  children: [{
				id: 5,
				label: '二级 2-1',
				type:'功能'
			  }, {
				id: 6,
				label: '二级 2-2',
				type:'菜单'
			  }]
			}, {
			  id: 3,
			  label: '一级 3',
			  type:'功能',
			  children: [{
				id: 7,
				label: '二级 3-1',
				type:'菜单'
			  }, {
				id: 8,
				label: '二级 3-2',
				type:'菜单'
			  }]
			}],
			defaultProps: {
			  children: 'children',
			  label: 'label'
			}
		  }
		},
		mounted(){
            $("#tableView").delegate(".el-tree-node__content","mouseover",function(){
				$(this).find(".treeNodeSpan").show();
			});
			$("#tableView").delegate(".el-tree-node__content","mouseout",function(){
				$(this).find(".treeNodeSpan").hide();
			});
        },
		methods: {
		  renderContent:function(createElement, { node, data, store }) {
					var self = this;
					var arr = [
						createElement('span', node.label),
						createElement('span', {attrs:{
							class:'treeNodeSpan'
						}},[
							createElement('i',{attrs:{
								class:"el-icon-plus",
								title:'添加'
							},on:{
								click:function() {
									console.info("点击了节点" + data.id + "的添加按钮");
									$(".form-div").load("treeForm.html",function(){
										//success
									})
									//store.append({ id: self.baseId++, label: 'testtest', children: [] }, data);
								}
							}}),
							createElement('i',{attrs:{
								class:"el-icon-edit",
								title:'编辑'
							},on:{
								click:function() {
									console.info("点击了节点" + data.id + "的编辑按钮");
									$(".form-div").load("treeForm.html",function(){
										//success
									})
									//store.append({ id: self.baseId++, label: 'testtest', children: [] }, data);
								}
							}}),
							createElement('i',{attrs:{
								class:"el-icon-delete",
								title:'删除'
							},on:{
								click:function() {
									console.info("点击了节点" + data.id + "的删除按钮");
									store.remove(data);
								}
							}}),
						]),
					]
					if(data.type=="功能"){
						arr.unshift(createElement('span', {attrs:{
							class:'el-icon-document',
							title:'类型为功能'
						}}));
						return createElement('span', arr);
					}else{
						return createElement('span', arr);
					}
					
				}
		}
   });

   //form表单
var formdiv = new Vue({  
        el: '#formdiv',  
        data() {
		  return {
			ruleForm: {
			  name: '',
			  type: '',
			  orders: '',
			  desc: ''
			},
			rules: {
			  name: [
				{ required: true, message: '请输入子节点名称', trigger: 'blur' }
			  ],
			  type: [
				 { required: true, message: '请选择类型', trigger: 'change' }
			  ],
			  orders: [
				{ type: 'date', required: true, message: '请选择顺序', trigger: 'blur' }
			  ],
			  desc: [
				{ required: true, message: '请填写描述', trigger: 'blur' }
			  ]
			}
		  }
		},
		methods: {
		  onSubmit(formName) {
			this.$refs[formName].validate((valid) => {
			  if (valid) {
				alert('submit!');
			  } else {
				console.log('error submit!!');
				return false;
			  }
			});
		  },
		  resetForm(formName) {
			this.$refs[formName].resetFields();
		  }
		}
   });


</script>
</body>
</html>










